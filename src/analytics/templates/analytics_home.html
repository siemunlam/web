{% extends 'base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block content %}

<div class="body-header">
    <h1 class="text-center font-bold">Reportes</h1>
</div>

<!-- Nav tabs -->
<ul class="nav nav-tabs nav-justified" role="tablist">
    <li role="presentation" class="active"><a href="#auxCat" aria-controls="Auxilios Cat" role="tab" data-toggle="tab">Solicitudes</a></li>
    <li role="presentation"><a href="#heatmap" aria-controls="Heat Map" role="tab" data-toggle="tab">Mapa de auxilios</a></li>
    <!-- <li role="presentation"><a href="#zonasAux" aria-controls="ZonasAux" role="tab" data-toggle="tab">Zonas de solicitudes</a></li> //TODO: Implementar -->
    <li role="presentation"><a href="#auxAten" aria-controls="AtencionAux" role="tab" data-toggle="tab">Atenci√≥n de auxilios</a></li>
</ul>

<!-- Tab panes -->
<div class="tab-content">
    <div role="tabpanel" class="tab-pane fade in active" id="auxCat">
        <div class="panel panel-default">
            <!-- Default panel contents -->
            <!-- GRAFICO DE TORTA CON LAS CATEGORIAS DE AUXILIOS
            Y UNO DE LINEA CON LA CANTIDAD DE AUXILIOS SOLICITADOS Y ATENDIDOS POR DIA -->
            <div class="basic">
            {% include "report_1.html" %}
            </div>
        </div>
    </div>
    
    <div role="tabpanel" class="tab-pane fade" id="heatmap">
         <div class="panel panel-default"> 
            <!-- Default panel contents -->
             <!-- <div class="basic">  -->
                <iframe id="iframe-heatmap" width="100%" height="500" frameborder="1" src="/heatmap"></iframe>                
            <!-- MAPA DE CALOR DE TODOS LOS AUXILIOS, UBICADOS CON COORDENADAS -->
             <!-- </div> -->
        </div> 
    </div>

    <div role="tabpanel" class="tab-pane fade" id="zonasAux">
        <div class="panel panel-default">
            <!-- Default panel contents -->
            <div class="basic">            
            <!-- ACA SE MUESTRAN... -->
            </div>
        </div>
    </div>

    <div role="tabpanel" class="tab-pane fade" id="auxAten">
        <div class="panel panel-default">
            <!-- Default panel contents -->
            <div class="basic">
             {% include "report_3.html" %}                
            <!-- ACA SE MUESTRAN LOS TIEMPOS PROMEDIOS DE DEMORA Y ATENCION DE LOS AUXILIOS -->
            </div>
        </div>
    </div>

</div>
{% endblock content %}

{% block extra-JS %}{{ block.super }}
<script src='{% static "js/utils.js" %}' type="text/javascript"></script>
<script>
    function redirectMapaMovilesMapa(url){
        document.getElementById('iframe-heatmap').src = url;
    };      
    //TODO(fcorrales): Hacer funcionar el evento para redirigir al mapa de calor
    // Se debe hacer pq sino a veces no centra el mapa.
    $('.nav-tabs a[href="#heatmap"]').on('show.bs.tab', event => {
        console.log("flag1");
        redirectMapaMovilesMapa('/heatmap');
    });
</script>
{% endblock extra-JS %}
